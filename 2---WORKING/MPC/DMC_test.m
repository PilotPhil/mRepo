% 阶跃响应---N=20个采样点
a=[0.0867,0.2917,0.5413,0.7851,0.9818,1.1166,1.1882,1.2059,1.1846,1.1407,1.0886,1.0394,1.001,0.9738,0.9603,0.9577,0.9627,0.9721,0.9829,0.9929;];
a1=a';

% 动态矩阵A 暂定控制时域P=N=20（行）,M=N=20（列）
A=zeros(20,20);
for P=1:20
    for M=1:P
        A(P,M)=a(P-M+1);
    end
end

% 误差权矩阵（对角阵：主对角线之外的元素皆为0的矩阵）
q=[0.5 0.4 0.3 0.3 0.1 0.1 0.08 0.06 0.04 0.02 0.01 0.008 0.006 0.004 0.002 0.001 0.001 0.001 0.001 0.001];
Q=diag(q);
% 控制全矩阵（对角阵）
r=[0.5 0.4 0.3 0.2 0.2 0.1 0.08 0.06 0.04 0.02 0.01 0.008 0.006 0.004 0.002 0.001 0.001 0.001 0.001 0.001]*10.5; 
R=diag(r);

c=zeros(20,1);              % 仅取M个控制增量向量的首元素
c(1)=1;                     % 弱水三千，只取一瓢
c1=c';
dt=c'/(A'*Q*A+R)*A'*Q;      % 控制向量

h=[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]';
v=ones(1,19);
S=diag(v,1);
S(20,20)=1;